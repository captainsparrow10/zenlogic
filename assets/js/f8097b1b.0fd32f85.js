"use strict";(globalThis.webpackChunkerp_docs=globalThis.webpackChunkerp_docs||[]).push([[6446],{6510:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"microservicios/auth-service/alcance","title":"Alcance del Auth Service","description":"\xbfQu\xe9 HACE el Auth Service?","source":"@site/docs/02-microservicios/auth-service/01-alcance.md","sourceDirName":"02-microservicios/auth-service","slug":"/microservicios/auth-service/alcance","permalink":"/zenlogic/microservicios/auth-service/alcance","draft":false,"unlisted":false,"editUrl":"https://github.com/your-repo/edit/main/docs/02-microservicios/auth-service/01-alcance.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docs","previous":{"title":"Auth Service - Overview","permalink":"/zenlogic/microservicios/auth-service/overview"},"next":{"title":"Arquitectura Interna","permalink":"/zenlogic/microservicios/auth-service/arquitectura"}}');var r=n(4848),l=n(8453);const d={sidebar_position:2},a="Alcance del Auth Service",c={},o=[{value:"\xbfQu\xe9 HACE el Auth Service?",id:"qu\xe9-hace-el-auth-service",level:2},{value:"1. Gesti\xf3n de Identidad",id:"1-gesti\xf3n-de-identidad",level:3},{value:"Usuarios",id:"usuarios",level:4},{value:"Organizaciones (Tenants)",id:"organizaciones-tenants",level:4},{value:"Locales (Sucursales)",id:"locales-sucursales",level:4},{value:"2. Autenticaci\xf3n",id:"2-autenticaci\xf3n",level:3},{value:"Login",id:"login",level:4},{value:"Refresh Token",id:"refresh-token",level:4},{value:"Logout",id:"logout",level:4},{value:"Verificaci\xf3n de Token",id:"verificaci\xf3n-de-token",level:4},{value:"3. Autorizaci\xf3n (RBAC)",id:"3-autorizaci\xf3n-rbac",level:3},{value:"Roles",id:"roles",level:4},{value:"Permisos",id:"permisos",level:4},{value:"Validaci\xf3n de Permisos",id:"validaci\xf3n-de-permisos",level:4},{value:"4. Token Management",id:"4-token-management",level:3},{value:"JWT",id:"jwt",level:4},{value:"Refresh Token",id:"refresh-token-1",level:4},{value:"Blacklist",id:"blacklist",level:4},{value:"5. Auditor\xeda",id:"5-auditor\xeda",level:3},{value:"Eventos de Seguridad",id:"eventos-de-seguridad",level:4},{value:"6. APIs P\xfablicas (REST)",id:"6-apis-p\xfablicas-rest",level:3},{value:"Endpoints de Autenticaci\xf3n",id:"endpoints-de-autenticaci\xf3n",level:4},{value:"Endpoints de Gesti\xf3n",id:"endpoints-de-gesti\xf3n",level:4},{value:"7. APIs Internas (gRPC)",id:"7-apis-internas-grpc",level:3},{value:"8. Eventos Publicados",id:"8-eventos-publicados",level:3},{value:"\xbfQu\xe9 NO HACE el Auth Service?",id:"qu\xe9-no-hace-el-auth-service",level:2},{value:"\u274c Validaci\xf3n de Negocio de Otros Servicios",id:"-validaci\xf3n-de-negocio-de-otros-servicios",level:3},{value:"\u274c Gesti\xf3n de Datos de Dominio",id:"-gesti\xf3n-de-datos-de-dominio",level:3},{value:"\u274c Registro de Auditor\xeda Completo",id:"-registro-de-auditor\xeda-completo",level:3},{value:"\u274c Autenticaci\xf3n con Terceros (OAuth, SAML)",id:"-autenticaci\xf3n-con-terceros-oauth-saml",level:3},{value:"\u274c Gesti\xf3n de Sesiones Complejas",id:"-gesti\xf3n-de-sesiones-complejas",level:3},{value:"\u274c Recuperaci\xf3n de Contrase\xf1a por Email",id:"-recuperaci\xf3n-de-contrase\xf1a-por-email",level:3},{value:"\u274c Two-Factor Authentication (2FA)",id:"-two-factor-authentication-2fa",level:3},{value:"\u274c Rate Limiting Global",id:"-rate-limiting-global",level:3},{value:"\u274c Gesti\xf3n de Planes y Billing",id:"-gesti\xf3n-de-planes-y-billing",level:3},{value:"\u274c An\xe1lisis y Reportes",id:"-an\xe1lisis-y-reportes",level:3},{value:"Matriz de Responsabilidades",id:"matriz-de-responsabilidades",level:2},{value:"L\xedmites y Validaciones",id:"l\xedmites-y-validaciones",level:2},{value:"L\xedmites por Plan",id:"l\xedmites-por-plan",level:3},{value:"Validaciones de Seguridad",id:"validaciones-de-seguridad",level:3},{value:"Dependencias",id:"dependencias",level:2},{value:"Auth Service depende de:",id:"auth-service-depende-de",level:3},{value:"Auth Service NO depende de:",id:"auth-service-no-depende-de",level:3},{value:"Otros servicios dependen de Auth Service:",id:"otros-servicios-dependen-de-auth-service",level:3},{value:"Pr\xf3ximos Pasos",id:"pr\xf3ximos-pasos",level:2}];function t(e){const i={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"alcance-del-auth-service",children:"Alcance del Auth Service"})}),"\n",(0,r.jsx)(i.h2,{id:"qu\xe9-hace-el-auth-service",children:"\xbfQu\xe9 HACE el Auth Service?"}),"\n",(0,r.jsx)(i.h3,{id:"1-gesti\xf3n-de-identidad",children:"1. Gesti\xf3n de Identidad"}),"\n",(0,r.jsx)(i.h4,{id:"usuarios",children:"Usuarios"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Crear, leer, actualizar, eliminar usuarios"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Activar/desactivar usuarios"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Asignar roles a usuarios"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Asignar locales/sucursales a usuarios"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Cambiar contrase\xf1as"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Validar fortaleza de contrase\xf1as"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Bloquear usuarios por intentos fallidos"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"organizaciones-tenants",children:"Organizaciones (Tenants)"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Crear organizaciones"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Actualizar informaci\xf3n de organizaciones"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Suspender/reactivar organizaciones"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Asignar m\xf3dulos a organizaciones seg\xfan plan"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Gestionar l\xedmites por plan (max_users, max_locals, etc.)"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"locales-sucursales",children:"Locales (Sucursales)"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Crear, leer, actualizar locales"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Activar/desactivar locales"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Vincular usuarios a locales"}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"2-autenticaci\xf3n",children:"2. Autenticaci\xf3n"}),"\n",(0,r.jsx)(i.h4,{id:"login",children:"Login"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Validar credenciales (email + password)"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Verificar bcrypt hash"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Generar Access Token (JWT)"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Generar Refresh Token"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Crear sesi\xf3n en Redis"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Registrar evento de login exitoso"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"refresh-token",children:"Refresh Token"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Validar Refresh Token"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Generar nuevo Access Token"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Rotar Refresh Token (opcional)"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"logout",children:"Logout"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Invalidar sesi\xf3n"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Agregar token a blacklist"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Limpiar Redis"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"verificaci\xf3n-de-token",children:"Verificaci\xf3n de Token"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Validar firma JWT (RS256)"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Validar expiraci\xf3n"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Consultar en blacklist"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Retornar informaci\xf3n del usuario"}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"3-autorizaci\xf3n-rbac",children:"3. Autorizaci\xf3n (RBAC)"}),"\n",(0,r.jsx)(i.h4,{id:"roles",children:"Roles"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Crear roles por organizaci\xf3n"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Actualizar roles"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Eliminar roles (si no est\xe1n asignados)"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Asignar permisos a roles"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Remover permisos de roles"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"permisos",children:"Permisos"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\u2705 Definir permisos del sistema (",(0,r.jsx)(i.code,{children:"catalog:read"}),", ",(0,r.jsx)(i.code,{children:"inventory:edit"}),", etc.)"]}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Listar permisos disponibles por m\xf3dulo"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Validar que permiso existe antes de asignar"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"validaci\xf3n-de-permisos",children:"Validaci\xf3n de Permisos"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Verificar si usuario tiene permiso espec\xedfico"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Verificar si usuario tiene acceso a local"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Verificar si m\xf3dulo est\xe1 habilitado para organizaci\xf3n"}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"4-token-management",children:"4. Token Management"}),"\n",(0,r.jsx)(i.h4,{id:"jwt",children:"JWT"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Generar Access Token con RS256"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Incluir claims: user_id, org_id, permissions, locals"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Configurar TTL (15 minutos)"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"refresh-token-1",children:"Refresh Token"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Generar Refresh Token"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Configurar TTL (7 d\xedas)"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Almacenar en Redis con metadata"}),"\n"]}),"\n",(0,r.jsx)(i.h4,{id:"blacklist",children:"Blacklist"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Agregar tokens revocados a blacklist"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Consultar blacklist en cada verificaci\xf3n"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Limpiar tokens expirados"}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"5-auditor\xeda",children:"5. Auditor\xeda"}),"\n",(0,r.jsx)(i.h4,{id:"eventos-de-seguridad",children:"Eventos de Seguridad"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Login exitoso"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Login fallido"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Intentos bloqueados"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Cambio de contrase\xf1a"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Usuario creado/actualizado/eliminado"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Rol creado/actualizado/eliminado"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Permisos modificados"}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"6-apis-p\xfablicas-rest",children:"6. APIs P\xfablicas (REST)"}),"\n",(0,r.jsx)(i.h4,{id:"endpoints-de-autenticaci\xf3n",children:"Endpoints de Autenticaci\xf3n"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:"POST   /auth/login\nPOST   /auth/refresh\nPOST   /auth/logout\nPOST   /auth/verify          (interno)\nPOST   /auth/change-password\n"})}),"\n",(0,r.jsx)(i.h4,{id:"endpoints-de-gesti\xf3n",children:"Endpoints de Gesti\xf3n"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:"GET    /api/v1/users\nPOST   /api/v1/users\nGET    /api/v1/users/:id\nPUT    /api/v1/users/:id\nDELETE /api/v1/users/:id\n\nGET    /api/v1/roles\nPOST   /api/v1/roles\nGET    /api/v1/roles/:id\nPUT    /api/v1/roles/:id\nDELETE /api/v1/roles/:id\n\nGET    /api/v1/permissions\n\nGET    /api/v1/locals\nPOST   /api/v1/locals\nPUT    /api/v1/locals/:id\nDELETE /api/v1/locals/:id\n\nGET    /api/v1/organizations\nPOST   /api/v1/organizations\nPUT    /api/v1/organizations/:id\n"})}),"\n",(0,r.jsx)(i.h3,{id:"7-apis-internas-grpc",children:"7. APIs Internas (gRPC)"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-protobuf",children:"service AuthService {\n  rpc VerifyToken(VerifyTokenRequest) returns (VerifyTokenResponse);\n  rpc GetUserPermissions(GetUserPermissionsRequest) returns (GetUserPermissionsResponse);\n}\n"})}),"\n",(0,r.jsx)(i.h3,{id:"8-eventos-publicados",children:"8. Eventos Publicados"}),"\n",(0,r.jsx)(i.p,{children:"Auth Service publica eventos a RabbitMQ para que otros servicios reaccionen:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:"auth.user.created\nauth.user.updated\nauth.user.deactivated\nauth.user.deleted\nauth.user.password_changed\n\nauth.role.created\nauth.role.updated\nauth.role.deleted\nauth.role.permissions_changed\n\nauth.permission.created\nauth.permission.updated\nauth.permission.deleted\n\nauth.organization.created\nauth.organization.updated\nauth.organization.suspended\nauth.organization.reactivated\nauth.organization.module_enabled\nauth.organization.module_disabled\n\nauth.local.created\nauth.local.updated\nauth.local.deleted\n\nauth.session.created\nauth.session.revoked\nauth.token.revoked\n"})}),"\n",(0,r.jsx)(i.h2,{id:"qu\xe9-no-hace-el-auth-service",children:"\xbfQu\xe9 NO HACE el Auth Service?"}),"\n",(0,r.jsx)(i.h3,{id:"-validaci\xf3n-de-negocio-de-otros-servicios",children:"\u274c Validaci\xf3n de Negocio de Otros Servicios"}),"\n",(0,r.jsxs)(i.p,{children:["Auth Service ",(0,r.jsx)(i.strong,{children:"NO"})," valida l\xf3gica de negocio espec\xedfica de otros microservicios."]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Ejemplo"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:['\u2705 Auth Service valida: "\xbfEste usuario tiene permiso ',(0,r.jsx)(i.code,{children:"catalog:create"}),'?"']}),"\n",(0,r.jsx)(i.li,{children:'\u274c Auth Service NO valida: "\xbfEste producto tiene stock disponible?"'}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"La validaci\xf3n de negocio es responsabilidad de cada servicio."}),"\n",(0,r.jsx)(i.h3,{id:"-gesti\xf3n-de-datos-de-dominio",children:"\u274c Gesti\xf3n de Datos de Dominio"}),"\n",(0,r.jsxs)(i.p,{children:["Auth Service ",(0,r.jsx)(i.strong,{children:"NO"})," gestiona entidades de dominio de otros servicios."]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"No maneja"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u274c Productos (Catalog Service)"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Inventario (Inventory Service)"}),"\n",(0,r.jsx)(i.li,{children:"\u274c \xd3rdenes (Order Service)"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Precios (Pricing Service)"}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"-registro-de-auditor\xeda-completo",children:"\u274c Registro de Auditor\xeda Completo"}),"\n",(0,r.jsxs)(i.p,{children:["Auth Service publica eventos de auditor\xeda, pero ",(0,r.jsx)(i.strong,{children:"NO"})," es responsable de almacenarlos a largo plazo."]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Responsabilidad de Audit Service"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Recibir eventos"}),"\n",(0,r.jsx)(i.li,{children:"Almacenar logs"}),"\n",(0,r.jsx)(i.li,{children:"Consultar historial"}),"\n",(0,r.jsx)(i.li,{children:"Generar reportes de auditor\xeda"}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["Auth Service solo ",(0,r.jsx)(i.strong,{children:"publica"})," eventos, no los consume."]}),"\n",(0,r.jsx)(i.h3,{id:"-autenticaci\xf3n-con-terceros-oauth-saml",children:"\u274c Autenticaci\xf3n con Terceros (OAuth, SAML)"}),"\n",(0,r.jsxs)(i.p,{children:["En esta versi\xf3n, Auth Service ",(0,r.jsx)(i.strong,{children:"NO"})," soporta:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u274c Login con Google"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Login con Microsoft"}),"\n",(0,r.jsx)(i.li,{children:"\u274c SAML SSO"}),"\n",(0,r.jsx)(i.li,{children:"\u274c LDAP/Active Directory"}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"Solo soporta autenticaci\xf3n por email/password con bcrypt."}),"\n",(0,r.jsx)(i.admonition,{title:"Futuro",type:"info",children:(0,r.jsx)(i.p,{children:"OAuth2/OIDC y SAML se pueden agregar en futuras versiones."})}),"\n",(0,r.jsx)(i.h3,{id:"-gesti\xf3n-de-sesiones-complejas",children:"\u274c Gesti\xf3n de Sesiones Complejas"}),"\n",(0,r.jsxs)(i.p,{children:["Auth Service ",(0,r.jsx)(i.strong,{children:"NO"})," maneja:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u274c M\xfaltiples dispositivos por sesi\xf3n"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Notificaciones de login desde nuevo dispositivo"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Geolocalizaci\xf3n de sesiones"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Device fingerprinting"}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"Maneja sesiones simples basadas en tokens JWT."}),"\n",(0,r.jsx)(i.h3,{id:"-recuperaci\xf3n-de-contrase\xf1a-por-email",children:"\u274c Recuperaci\xf3n de Contrase\xf1a por Email"}),"\n",(0,r.jsxs)(i.p,{children:["Auth Service ",(0,r.jsx)(i.strong,{children:"NO"})," env\xeda emails."]}),"\n",(0,r.jsx)(i.p,{children:"Para recuperaci\xf3n de contrase\xf1a:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsx)(i.li,{children:"Auth Service genera token de recuperaci\xf3n"}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Notification Service"})," (externo) env\xeda el email"]}),"\n"]}),"\n",(0,r.jsx)(i.admonition,{type:"tip",children:(0,r.jsx)(i.p,{children:"Separaci\xf3n de responsabilidades: Auth gestiona tokens, Notification env\xeda emails."})}),"\n",(0,r.jsx)(i.h3,{id:"-two-factor-authentication-2fa",children:"\u274c Two-Factor Authentication (2FA)"}),"\n",(0,r.jsxs)(i.p,{children:["En esta versi\xf3n, Auth Service ",(0,r.jsx)(i.strong,{children:"NO"})," soporta:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u274c TOTP (Google Authenticator)"}),"\n",(0,r.jsx)(i.li,{children:"\u274c SMS OTP"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Email OTP"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Biometr\xeda"}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"Solo autenticaci\xf3n de un factor (email + password)."}),"\n",(0,r.jsx)(i.h3,{id:"-rate-limiting-global",children:"\u274c Rate Limiting Global"}),"\n",(0,r.jsxs)(i.p,{children:["Auth Service tiene rate limiting b\xe1sico en ",(0,r.jsx)(i.code,{children:"/auth/login"}),", pero ",(0,r.jsx)(i.strong,{children:"NO"})," gestiona rate limiting global del API Gateway."]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Responsabilidad de API Gateway"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Rate limiting por IP"}),"\n",(0,r.jsx)(i.li,{children:"Rate limiting por usuario"}),"\n",(0,r.jsx)(i.li,{children:"Rate limiting por tenant"}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"-gesti\xf3n-de-planes-y-billing",children:"\u274c Gesti\xf3n de Planes y Billing"}),"\n",(0,r.jsxs)(i.p,{children:["Auth Service conoce el plan de cada organizaci\xf3n (",(0,r.jsx)(i.code,{children:"basic"}),", ",(0,r.jsx)(i.code,{children:"pro"}),", ",(0,r.jsx)(i.code,{children:"enterprise"}),"), pero ",(0,r.jsx)(i.strong,{children:"NO"})," gestiona:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u274c Pagos"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Facturaci\xf3n"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Upgrades/downgrades de plan"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Renovaciones"}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["Eso es responsabilidad de un ",(0,r.jsx)(i.strong,{children:"Billing Service"})," (futuro)."]}),"\n",(0,r.jsx)(i.h3,{id:"-an\xe1lisis-y-reportes",children:"\u274c An\xe1lisis y Reportes"}),"\n",(0,r.jsxs)(i.p,{children:["Auth Service publica eventos, pero ",(0,r.jsx)(i.strong,{children:"NO"})," genera:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u274c Reportes de usuarios activos"}),"\n",(0,r.jsx)(i.li,{children:"\u274c An\xe1lisis de patrones de login"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Dashboards de seguridad"}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["Eso es responsabilidad de ",(0,r.jsx)(i.strong,{children:"Analytics Service"})," o ",(0,r.jsx)(i.strong,{children:"Audit Service"}),"."]}),"\n",(0,r.jsx)(i.h2,{id:"matriz-de-responsabilidades",children:"Matriz de Responsabilidades"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Funcionalidad"}),(0,r.jsx)(i.th,{children:"Auth Service"}),(0,r.jsx)(i.th,{children:"Otro Servicio"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Crear usuario"}),(0,r.jsx)(i.td,{children:"\u2705"}),(0,r.jsx)(i.td,{children:"-"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Validar credenciales"}),(0,r.jsx)(i.td,{children:"\u2705"}),(0,r.jsx)(i.td,{children:"-"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Generar JWT"}),(0,r.jsx)(i.td,{children:"\u2705"}),(0,r.jsx)(i.td,{children:"-"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Verificar JWT"}),(0,r.jsx)(i.td,{children:"\u2705"}),(0,r.jsx)(i.td,{children:"-"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Asignar roles"}),(0,r.jsx)(i.td,{children:"\u2705"}),(0,r.jsx)(i.td,{children:"-"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Validar permisos"}),(0,r.jsx)(i.td,{children:"\u2705"}),(0,r.jsx)(i.td,{children:"-"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Gestionar organizaciones"}),(0,r.jsx)(i.td,{children:"\u2705"}),(0,r.jsx)(i.td,{children:"-"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Gestionar locales"}),(0,r.jsx)(i.td,{children:"\u2705"}),(0,r.jsx)(i.td,{children:"-"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Publicar eventos de auth"}),(0,r.jsx)(i.td,{children:"\u2705"}),(0,r.jsx)(i.td,{children:"-"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Almacenar logs de auditor\xeda"})}),(0,r.jsx)(i.td,{children:"\u274c"}),(0,r.jsx)(i.td,{children:"Audit Service"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Validar stock de producto"})}),(0,r.jsx)(i.td,{children:"\u274c"}),(0,r.jsx)(i.td,{children:"Inventory Service"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Enviar emails"})}),(0,r.jsx)(i.td,{children:"\u274c"}),(0,r.jsx)(i.td,{children:"Notification Service"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Procesar pagos"})}),(0,r.jsx)(i.td,{children:"\u274c"}),(0,r.jsx)(i.td,{children:"Billing Service"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Gestionar productos"})}),(0,r.jsx)(i.td,{children:"\u274c"}),(0,r.jsx)(i.td,{children:"Catalog Service"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Crear \xf3rdenes"})}),(0,r.jsx)(i.td,{children:"\u274c"}),(0,r.jsx)(i.td,{children:"Order Service"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Rate limiting global"})}),(0,r.jsx)(i.td,{children:"\u274c"}),(0,r.jsx)(i.td,{children:"API Gateway"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Analytics"})}),(0,r.jsx)(i.td,{children:"\u274c"}),(0,r.jsx)(i.td,{children:"Analytics Service"})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"l\xedmites-y-validaciones",children:"L\xedmites y Validaciones"}),"\n",(0,r.jsx)(i.h3,{id:"l\xedmites-por-plan",children:"L\xedmites por Plan"}),"\n",(0,r.jsx)(i.p,{children:"Auth Service valida l\xedmites seg\xfan el plan de la organizaci\xf3n:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-json",children:'{\n  "basic": {\n    "max_users": 10,\n    "max_locals": 1,\n    "max_products": 1000,\n    "modules": ["catalog"]\n  },\n  "pro": {\n    "max_users": 50,\n    "max_locals": 5,\n    "max_products": 10000,\n    "modules": ["catalog", "inventory", "orders"]\n  },\n  "enterprise": {\n    "max_users": "unlimited",\n    "max_locals": "unlimited",\n    "max_products": "unlimited",\n    "modules": ["all"]\n  }\n}\n'})}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Validaciones realizadas"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\u2705 No exceder ",(0,r.jsx)(i.code,{children:"max_users"})," al crear usuario"]}),"\n",(0,r.jsxs)(i.li,{children:["\u2705 No exceder ",(0,r.jsx)(i.code,{children:"max_locals"})," al crear local"]}),"\n",(0,r.jsx)(i.li,{children:"\u2705 No permitir uso de m\xf3dulos no habilitados"}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Validaciones NO realizadas"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["\u274c No valida ",(0,r.jsx)(i.code,{children:"max_products"})," (responsabilidad de Catalog Service)"]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"validaciones-de-seguridad",children:"Validaciones de Seguridad"}),"\n",(0,r.jsx)(i.p,{children:"Auth Service valida:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Contrase\xf1as"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 M\xednimo 8 caracteres"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Al menos una may\xfascula"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Al menos un n\xfamero"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Al menos un car\xe1cter especial (opcional)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Emails"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Formato v\xe1lido (regex)"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 \xdanico por organizaci\xf3n"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Tokens"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Firma v\xe1lida (RS256)"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 No expirado"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 No en blacklist"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Permisos"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Permiso existe antes de asignar"}),"\n",(0,r.jsx)(i.li,{children:"\u2705 Usuario tiene permiso antes de autorizar"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.strong,{children:"Locales"}),":"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u2705 Usuario tiene acceso al local solicitado"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"dependencias",children:"Dependencias"}),"\n",(0,r.jsx)(i.h3,{id:"auth-service-depende-de",children:"Auth Service depende de:"}),"\n",(0,r.jsxs)(i.ol,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"PostgreSQL"}),": Base de datos principal"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Redis"}),": Cache y sesiones"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"RabbitMQ"}),": Publicaci\xf3n de eventos"]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"auth-service-no-depende-de",children:"Auth Service NO depende de:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"\u274c Catalog Service"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Inventory Service"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Order Service"}),"\n",(0,r.jsx)(i.li,{children:"\u274c Audit Service"}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["Auth Service es ",(0,r.jsx)(i.strong,{children:"independiente"})," y puede funcionar sin otros microservicios."]}),"\n",(0,r.jsx)(i.h3,{id:"otros-servicios-dependen-de-auth-service",children:"Otros servicios dependen de Auth Service:"}),"\n",(0,r.jsx)(i.p,{children:"Todos los microservicios dependen de Auth Service para:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Verificar tokens"}),"\n",(0,r.jsx)(i.li,{children:"Obtener permisos de usuario"}),"\n",(0,r.jsx)(i.li,{children:"Validar acceso a recursos"}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"pr\xf3ximos-pasos",children:"Pr\xf3ximos Pasos"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/microservicios/auth-service/arquitectura",children:"Arquitectura"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/microservicios/auth-service/modelo-datos",children:"Modelo de Datos"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"/microservicios/auth-service/api-auth",children:"API Auth"})}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,l.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>d,x:()=>a});var s=n(6540);const r={},l=s.createContext(r);function d(e){const i=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(l.Provider,{value:i},e.children)}}}]);