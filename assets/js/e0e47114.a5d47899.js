"use strict";(globalThis.webpackChunkerp_docs=globalThis.webpackChunkerp_docs||[]).push([[1596],{6455:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>j,frontMatter:()=>i,metadata:()=>d,toc:()=>o});const d=JSON.parse('{"id":"microservicios/inventory-service/api-adjustments","title":"Adjustments API","description":"API REST para ajustes de inventario con aprobaciones, motivos y auditor\xeda completa.","source":"@site/docs/02-microservicios/inventory-service/12-api-adjustments.md","sourceDirName":"02-microservicios/inventory-service","slug":"/microservicios/inventory-service/api-adjustments","permalink":"/zenlogic/microservicios/inventory-service/api-adjustments","draft":false,"unlisted":false,"editUrl":"https://github.com/your-repo/edit/main/docs/02-microservicios/inventory-service/12-api-adjustments.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12},"sidebar":"docs","previous":{"title":"Transfers API","permalink":"/zenlogic/microservicios/inventory-service/api-transfers"},"next":{"title":"Locations API","permalink":"/zenlogic/microservicios/inventory-service/api-locations"}}');var r=s(4848),t=s(8453);const i={sidebar_position:12},a="Adjustments API",c={},o=[{value:"Endpoints",id:"endpoints",level:2},{value:"Listar Ajustes",id:"listar-ajustes",level:3},{value:"Obtener Ajuste por ID",id:"obtener-ajuste-por-id",level:3},{value:"Crear Ajuste",id:"crear-ajuste",level:3},{value:"Aprobar Ajuste",id:"aprobar-ajuste",level:3},{value:"Rechazar Ajuste",id:"rechazar-ajuste",level:3},{value:"Reporte de Ajustes",id:"reporte-de-ajustes",level:3},{value:"Motivos de Ajuste",id:"motivos-de-ajuste",level:2},{value:"Ajustes Negativos",id:"ajustes-negativos",level:3},{value:"Ajustes Positivos",id:"ajustes-positivos",level:3},{value:"Configuraci\xf3n de Aprobaciones",id:"configuraci\xf3n-de-aprobaciones",level:2},{value:"Permisos Requeridos",id:"permisos-requeridos",level:2},{value:"Eventos Publicados",id:"eventos-publicados",level:2},{value:"Pr\xf3ximos Pasos",id:"pr\xf3ximos-pasos",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"adjustments-api",children:"Adjustments API"})}),"\n",(0,r.jsx)(n.p,{children:"API REST para ajustes de inventario con aprobaciones, motivos y auditor\xeda completa."}),"\n",(0,r.jsx)(n.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,r.jsx)(n.h3,{id:"listar-ajustes",children:"Listar Ajustes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /api/v1/adjustments\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Query Parameters:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metro"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Requerido"}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"stock_id"})}),(0,r.jsx)(n.td,{children:"UUID"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Filtrar por stock"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"variant_id"})}),(0,r.jsx)(n.td,{children:"UUID"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Filtrar por variante"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"warehouse_id"})}),(0,r.jsx)(n.td,{children:"UUID"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Filtrar por bodega"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"adjustment_type"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"positive, negative"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"reason"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"damaged, expired, lost, found, audit, other"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"status"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"pending, approved, rejected, applied"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"created_by"})}),(0,r.jsx)(n.td,{children:"UUID"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Usuario creador"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"date_from"})}),(0,r.jsx)(n.td,{children:"date"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Fecha desde"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"date_to"})}),(0,r.jsx)(n.td,{children:"date"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Fecha hasta"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"cursor"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Cursor de paginaci\xf3n"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"limit"})}),(0,r.jsx)(n.td,{children:"integer"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Resultados por p\xe1gina (max: 100)"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Respuesta Exitosa (200 OK):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success",\n  "statusCode": 200,\n  "data": {\n    "edges": [\n      {\n        "cursor": "YWRqXzEyMw==",\n        "node": {\n          "adjustment_id": "adj_123",\n          "stock_id": "stock_456",\n          "stock": {\n            "variant_id": "var_789",\n            "variant_sku": "PROD-001",\n            "warehouse_id": "wh_101",\n            "warehouse_name": "Bodega Principal"\n          },\n          "adjustment_type": "negative",\n          "reason": "damaged",\n          "quantities": {\n            "quantity_before": 150,\n            "quantity_after": 145,\n            "quantity_change": -5\n          },\n          "status": "applied",\n          "created_by": {\n            "user_id": "user_456",\n            "name": "Juan P\xe9rez"\n          },\n          "approved_by": {\n            "user_id": "user_789",\n            "name": "Mar\xeda Garc\xeda",\n            "approval_date": "2025-11-23T14:00:00Z"\n          },\n          "notes": "Productos da\xf1ados durante transporte interno",\n          "created_at": "2025-11-23T10:00:00Z",\n          "updated_at": "2025-11-23T14:30:00Z"\n        }\n      }\n    ],\n    "pageInfo": {\n      "hasNextPage": true,\n      "totalCount": 87\n    }\n  },\n  "timestamp": "2025-11-23T15:00:00Z",\n  "path": "/api/v1/adjustments",\n  "requestId": "req_adj123"\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"obtener-ajuste-por-id",children:"Obtener Ajuste por ID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /api/v1/adjustments/{adjustmentId}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Respuesta Exitosa (200 OK):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success",\n  "statusCode": 200,\n  "data": {\n    "adjustment_id": "adj_123",\n    "stock_id": "stock_456",\n    "variant": {\n      "variant_id": "var_789",\n      "sku": "PROD-001-RED",\n      "name": "Producto Ejemplo - Rojo"\n    },\n    "warehouse": {\n      "warehouse_id": "wh_101",\n      "name": "Bodega Principal",\n      "code": "WH-001"\n    },\n    "adjustment_type": "negative",\n    "reason": "damaged",\n    "quantities": {\n      "quantity_before": 150,\n      "quantity_after": 145,\n      "quantity_change": -5,\n      "percentage_change": -3.33\n    },\n    "status": "applied",\n    "created_by": {\n      "user_id": "user_456",\n      "name": "Juan P\xe9rez",\n      "email": "juan.perez@example.com"\n    },\n    "approved_by": {\n      "user_id": "user_789",\n      "name": "Mar\xeda Garc\xeda",\n      "email": "maria.garcia@example.com",\n      "approval_date": "2025-11-23T14:00:00Z"\n    },\n    "notes": "Productos da\xf1ados durante transporte interno - Carretilla choc\xf3 estanter\xeda",\n    "metadata": {\n      "incident_report": "IR-2025-0123",\n      "photos": ["img1.jpg", "img2.jpg"]\n    },\n    "audit_trail": [\n      {\n        "status": "pending",\n        "timestamp": "2025-11-23T10:00:00Z",\n        "user": "Juan P\xe9rez",\n        "action": "created"\n      },\n      {\n        "status": "approved",\n        "timestamp": "2025-11-23T14:00:00Z",\n        "user": "Mar\xeda Garc\xeda",\n        "action": "approved"\n      },\n      {\n        "status": "applied",\n        "timestamp": "2025-11-23T14:30:00Z",\n        "user": "Sistema",\n        "action": "stock_adjusted"\n      }\n    ],\n    "created_at": "2025-11-23T10:00:00Z",\n    "updated_at": "2025-11-23T14:30:00Z"\n  },\n  "timestamp": "2025-11-23T15:00:00Z",\n  "path": "/api/v1/adjustments/adj_123",\n  "requestId": "req_getadj123"\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"crear-ajuste",children:"Crear Ajuste"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"POST /api/v1/adjustments\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "stock_id": "stock_456",\n  "adjustment_type": "negative",\n  "quantity_change": -5,\n  "reason": "damaged",\n  "notes": "Productos da\xf1ados durante transporte interno",\n  "metadata": {\n    "incident_report": "IR-2025-0123",\n    "photos": ["img1.jpg", "img2.jpg"]\n  },\n  "auto_approve": false\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Campos:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Campo"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Requerido"}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"stock_id"})}),(0,r.jsx)(n.td,{children:"UUID"}),(0,r.jsx)(n.td,{children:"S\xed"}),(0,r.jsx)(n.td,{children:"ID del stock a ajustar"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"adjustment_type"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"S\xed"}),(0,r.jsx)(n.td,{children:"positive, negative"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"quantity_change"})}),(0,r.jsx)(n.td,{children:"integer"}),(0,r.jsx)(n.td,{children:"S\xed"}),(0,r.jsx)(n.td,{children:"Cambio en cantidad (con signo)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"reason"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"S\xed"}),(0,r.jsx)(n.td,{children:"damaged, expired, lost, found, audit, other"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"notes"})}),(0,r.jsx)(n.td,{children:"text"}),(0,r.jsx)(n.td,{children:"S\xed"}),(0,r.jsx)(n.td,{children:"Justificaci\xf3n del ajuste"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"metadata"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Informaci\xf3n adicional"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"auto_approve"})}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Auto-aprobar si est\xe1 permitido (default: false)"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validaciones:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"quantity_change"})," debe coincidir con ",(0,r.jsx)(n.code,{children:"adjustment_type"})," (positivo/negativo)"]}),"\n",(0,r.jsxs)(n.li,{children:["Para ajustes negativos: ",(0,r.jsx)(n.code,{children:"abs(quantity_change)"})," no puede ser mayor al stock disponible"]}),"\n",(0,r.jsx)(n.li,{children:"Ajustes mayores al X% requieren aprobaci\xf3n obligatoria (configurable)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Respuesta Exitosa (201 Created):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success",\n  "statusCode": 201,\n  "data": {\n    "adjustment_id": "adj_new456",\n    "stock_id": "stock_456",\n    "adjustment_type": "negative",\n    "quantity_change": -5,\n    "reason": "damaged",\n    "status": "pending",\n    "requires_approval": true,\n    "created_at": "2025-11-23T16:00:00Z"\n  },\n  "timestamp": "2025-11-23T16:00:00Z",\n  "path": "/api/v1/adjustments",\n  "requestId": "req_createadj456"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"C\xf3digos de Error:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"400"})," - ",(0,r.jsx)(n.code,{children:"INVALID_ADJUSTMENT_DATA"}),": Datos inv\xe1lidos"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"400"})," - ",(0,r.jsx)(n.code,{children:"QUANTITY_EXCEEDS_STOCK"}),": Ajuste negativo excede stock disponible"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"404"})," - ",(0,r.jsx)(n.code,{children:"STOCK_NOT_FOUND"}),": Stock no existe"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"400"})," - ",(0,r.jsx)(n.code,{children:"QUANTITY_SIGN_MISMATCH"}),": Signo de cantidad no coincide con tipo"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Evento Publicado:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "event": "inventory.adjustment.created",\n  "data": {\n    "adjustment_id": "adj_new456",\n    "stock_id": "stock_456",\n    "adjustment_type": "negative",\n    "quantity_change": -5,\n    "status": "pending"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"aprobar-ajuste",children:"Aprobar Ajuste"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"POST /api/v1/adjustments/{adjustmentId}/approve\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "notes": "Aprobado - Revisado reporte de incidente"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Respuesta Exitosa (200 OK):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success",\n  "statusCode": 200,\n  "data": {\n    "adjustment_id": "adj_123",\n    "status": "approved",\n    "approved_by": {\n      "user_id": "user_789",\n      "name": "Mar\xeda Garc\xeda"\n    },\n    "approval_date": "2025-11-23T16:30:00Z",\n    "will_auto_apply": true,\n    "estimated_apply_time": "2025-11-23T16:30:05Z"\n  },\n  "timestamp": "2025-11-23T16:30:00Z",\n  "path": "/api/v1/adjustments/adj_123/approve",\n  "requestId": "req_approve123"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"C\xf3digos de Error:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"404"})," - ",(0,r.jsx)(n.code,{children:"ADJUSTMENT_NOT_FOUND"}),": Ajuste no existe"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"409"})," - ",(0,r.jsx)(n.code,{children:"ADJUSTMENT_ALREADY_APPROVED"}),": Ya fue aprobado"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"409"})," - ",(0,r.jsx)(n.code,{children:"ADJUSTMENT_ALREADY_APPLIED"}),": Ya fue aplicado"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"409"})," - ",(0,r.jsx)(n.code,{children:"ADJUSTMENT_REJECTED"}),": Ajuste fue rechazado"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"403"})," - ",(0,r.jsx)(n.code,{children:"INSUFFICIENT_PERMISSIONS"}),": Sin permisos para aprobar"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Evento Publicado:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "event": "inventory.adjustment.approved",\n  "data": {\n    "adjustment_id": "adj_123",\n    "approved_by": "user_789",\n    "approval_date": "2025-11-23T16:30:00Z"\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Nota:"})," Al aprobar, el ajuste se aplica autom\xe1ticamente al stock."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"rechazar-ajuste",children:"Rechazar Ajuste"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"POST /api/v1/adjustments/{adjustmentId}/reject\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "reason": "Falta evidencia fotogr\xe1fica",\n  "notes": "Por favor adjuntar fotos del da\xf1o antes de re-enviar"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Respuesta Exitosa (200 OK):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success",\n  "statusCode": 200,\n  "data": {\n    "adjustment_id": "adj_123",\n    "status": "rejected",\n    "rejected_by": {\n      "user_id": "user_789",\n      "name": "Mar\xeda Garc\xeda"\n    },\n    "rejection_reason": "Falta evidencia fotogr\xe1fica",\n    "rejected_at": "2025-11-23T16:45:00Z"\n  },\n  "timestamp": "2025-11-23T16:45:00Z",\n  "path": "/api/v1/adjustments/adj_123/reject",\n  "requestId": "req_reject123"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"C\xf3digos de Error:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"409"})," - ",(0,r.jsx)(n.code,{children:"ADJUSTMENT_ALREADY_APPROVED"}),": Ya fue aprobado"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"409"})," - ",(0,r.jsx)(n.code,{children:"ADJUSTMENT_ALREADY_APPLIED"}),": Ya fue aplicado"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Evento Publicado:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "event": "inventory.adjustment.rejected",\n  "data": {\n    "adjustment_id": "adj_123",\n    "rejected_by": "user_789",\n    "reason": "Falta evidencia fotogr\xe1fica"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"reporte-de-ajustes",children:"Reporte de Ajustes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /api/v1/adjustments/report\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Query Parameters:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Par\xe1metro"}),(0,r.jsx)(n.th,{children:"Tipo"}),(0,r.jsx)(n.th,{children:"Requerido"}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"date_from"})}),(0,r.jsx)(n.td,{children:"date"}),(0,r.jsx)(n.td,{children:"S\xed"}),(0,r.jsx)(n.td,{children:"Fecha desde (YYYY-MM-DD)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"date_to"})}),(0,r.jsx)(n.td,{children:"date"}),(0,r.jsx)(n.td,{children:"S\xed"}),(0,r.jsx)(n.td,{children:"Fecha hasta (YYYY-MM-DD)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"warehouse_id"})}),(0,r.jsx)(n.td,{children:"UUID"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Filtrar por bodega"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"group_by"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"reason, warehouse, type, user"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Respuesta Exitosa (200 OK):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success",\n  "statusCode": 200,\n  "data": {\n    "period": {\n      "from": "2025-11-01",\n      "to": "2025-11-30",\n      "days": 30\n    },\n    "summary": {\n      "total_adjustments": 87,\n      "positive_adjustments": 12,\n      "negative_adjustments": 75,\n      "net_quantity_change": -250,\n      "total_value_impact": -12500.00,\n      "pending_approvals": 5,\n      "approved": 70,\n      "rejected": 12\n    },\n    "by_reason": [\n      {\n        "reason": "damaged",\n        "count": 45,\n        "total_quantity": -180,\n        "percentage": 51.7\n      },\n      {\n        "reason": "expired",\n        "count": 20,\n        "total_quantity": -50,\n        "percentage": 23.0\n      },\n      {\n        "reason": "lost",\n        "count": 8,\n        "total_quantity": -15,\n        "percentage": 9.2\n      },\n      {\n        "reason": "found",\n        "count": 10,\n        "total_quantity": 25,\n        "percentage": 11.5\n      },\n      {\n        "reason": "audit",\n        "count": 4,\n        "total_quantity": -30,\n        "percentage": 4.6\n      }\n    ],\n    "by_warehouse": [\n      {\n        "warehouse_id": "wh_101",\n        "warehouse_name": "Bodega Principal",\n        "count": 55,\n        "net_change": -180\n      },\n      {\n        "warehouse_id": "wh_102",\n        "warehouse_name": "Bodega Sucursal",\n        "count": 32,\n        "net_change": -70\n      }\n    ],\n    "top_variants_adjusted": [\n      {\n        "variant_id": "var_789",\n        "sku": "PROD-001",\n        "adjustments_count": 8,\n        "total_change": -25\n      }\n    ]\n  },\n  "timestamp": "2025-11-23T15:00:00Z",\n  "path": "/api/v1/adjustments/report",\n  "requestId": "req_adjreport123"\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"motivos-de-ajuste",children:"Motivos de Ajuste"}),"\n",(0,r.jsx)(n.h3,{id:"ajustes-negativos",children:"Ajustes Negativos"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Motivo"}),(0,r.jsx)(n.th,{children:"C\xf3digo"}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Da\xf1ado"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"damaged"})}),(0,r.jsx)(n.td,{children:"Productos da\xf1ados"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Vencido"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"expired"})}),(0,r.jsx)(n.td,{children:"Productos con fecha vencida"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Perdido"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"lost"})}),(0,r.jsx)(n.td,{children:"Inventario perdido/robado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Auditor\xeda"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"audit"})}),(0,r.jsx)(n.td,{children:"Ajuste por conteo f\xedsico"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Otro"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"other"})}),(0,r.jsx)(n.td,{children:"Otro motivo (especificar)"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"ajustes-positivos",children:"Ajustes Positivos"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Motivo"}),(0,r.jsx)(n.th,{children:"C\xf3digo"}),(0,r.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Encontrado"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"found"})}),(0,r.jsx)(n.td,{children:"Inventario encontrado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Auditor\xeda"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"audit"})}),(0,r.jsx)(n.td,{children:"Ajuste por conteo f\xedsico"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Otro"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"other"})}),(0,r.jsx)(n.td,{children:"Otro motivo (especificar)"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"configuraci\xf3n-de-aprobaciones",children:"Configuraci\xf3n de Aprobaciones"}),"\n",(0,r.jsx)(n.p,{children:"Los ajustes requieren aprobaci\xf3n si:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Valor absoluto mayor a umbral:"})," ",(0,r.jsx)(n.code,{children:"abs(quantity_change) > MAX_ADJUSTMENT_QUANTITY"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Porcentaje mayor a umbral:"})," ",(0,r.jsx)(n.code,{children:"(abs(quantity_change) / current_stock) > MAX_ADJUSTMENT_PERCENTAGE"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Raz\xf3n espec\xedfica:"})," Configuraci\xf3n por organizaci\xf3n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Variables de Entorno:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"MAX_ADJUSTMENT_QUANTITY=100\nMAX_ADJUSTMENT_PERCENTAGE=0.1  # 10%\nADJUSTMENT_REQUIRE_APPROVAL=true\nADJUSTMENT_AUTO_APPLY_ON_APPROVE=true\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"permisos-requeridos",children:"Permisos Requeridos"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Endpoint"}),(0,r.jsx)(n.th,{children:"Permiso Requerido"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GET /adjustments"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"inventory.adjustments.read"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GET /adjustments/{id}"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"inventory.adjustments.read"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"POST /adjustments"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"inventory.adjustments.create"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"POST /adjustments/{id}/approve"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"inventory.adjustments.approve"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"POST /adjustments/{id}/reject"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"inventory.adjustments.approve"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GET /adjustments/report"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"inventory.adjustments.read"})})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"eventos-publicados",children:"Eventos Publicados"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inventory.adjustment.created"})," - Ajuste creado"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inventory.adjustment.approved"})," - Ajuste aprobado"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inventory.adjustment.rejected"})," - Ajuste rechazado"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inventory.adjustment.applied"})," - Ajuste aplicado al stock"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"inventory.stock.updated"})," - Stock actualizado (autom\xe1tico)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"pr\xf3ximos-pasos",children:"Pr\xf3ximos Pasos"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"./api-locations",children:"API: Locations"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"./eventos-publicados",children:"Eventos Publicados"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"./errores-comunes",children:"Errores Comunes"})}),"\n"]})]})}function j(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>a});var d=s(6540);const r={},t=d.createContext(r);function i(e){const n=d.useContext(t);return d.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),d.createElement(t.Provider,{value:n},e.children)}}}]);